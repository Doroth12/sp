<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot methods for spatial data with attributes — spplot • sp</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot methods for spatial data with attributes — spplot" />
<meta property="og:description" content="Lattice (trellis) plot methods for spatial data with attributes" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edzer/sp/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot methods for spatial data with attributes</h1>
    
    <div class="hidden name"><code>spplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Lattice (trellis) plot methods for spatial data with attributes</p>
    </div>

    <pre class="usage"><span class='fu'>spplot</span>(<span class='no'>obj</span>, <span class='no'>...</span>)
<span class='fu'>spplot.grid</span>(<span class='no'>obj</span>, <span class='kw'>zcol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>obj</span>), <span class='no'>...</span>, <span class='no'>names.attr</span>, <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>draw</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>),
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>aspect</span> <span class='kw'>=</span> <span class='fu'><a href='mapasp.html'>mapasp</a></span>(<span class='no'>obj</span>,<span class='no'>xlim</span>,<span class='no'>ylim</span>),
 <span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.gridplot</span>, <span class='kw'>sp.layout</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>formula</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='bbox.html'>bbox</a></span>(<span class='no'>obj</span>)[<span class='fl'>1</span>, ],
 <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='bbox.html'>bbox</a></span>(<span class='no'>obj</span>)[<span class='fl'>2</span>, ], <span class='kw'>checkEmptyRC</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>col.regions</span> <span class='kw'>=</span> <span class='fu'>get_col_regions</span>())
<span class='fu'>spplot.polygons</span>(<span class='no'>obj</span>, <span class='kw'>zcol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>obj</span>), <span class='no'>...</span>, <span class='no'>names.attr</span>, <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>draw</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>),
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>aspect</span> <span class='kw'>=</span> <span class='fu'><a href='mapasp.html'>mapasp</a></span>(<span class='no'>obj</span>,<span class='no'>xlim</span>,<span class='no'>ylim</span>),
 <span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.polygonsplot</span>, <span class='kw'>sp.layout</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>formula</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='bbox.html'>bbox</a></span>(<span class='no'>obj</span>)[<span class='fl'>1</span>, ],
 <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='bbox.html'>bbox</a></span>(<span class='no'>obj</span>)[<span class='fl'>2</span>, ], <span class='kw'>col.regions</span> <span class='kw'>=</span> <span class='fu'>get_col_regions</span>())
<span class='fu'>spplot.points</span>(<span class='no'>obj</span>, <span class='kw'>zcol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>obj</span>), <span class='no'>...</span>, <span class='no'>names.attr</span>, <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>draw</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>),
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>aspect</span> <span class='kw'>=</span> <span class='fu'><a href='mapasp.html'>mapasp</a></span>(<span class='no'>obj</span>,<span class='no'>xlim</span>,<span class='no'>ylim</span>),
 <span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.pointsplot</span>, <span class='kw'>sp.layout</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>identify</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>formula</span>,
 <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='panel.html'>bbexpand</a></span>(<span class='fu'><a href='bbox.html'>bbox</a></span>(<span class='no'>obj</span>)[<span class='fl'>1</span>, ], <span class='fl'>0.04</span>), <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='panel.html'>bbexpand</a></span>(<span class='fu'><a href='bbox.html'>bbox</a></span>(<span class='no'>obj</span>)[<span class='fl'>2</span>, ], <span class='fl'>0.04</span>),
 <span class='kw'>edge.col</span> <span class='kw'>=</span> <span class='st'>"transparent"</span>, <span class='kw'>colorkey</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>col.regions</span> <span class='kw'>=</span> <span class='fu'>get_col_regions</span>())
<span class='fu'>mapLegendGrob</span>(<span class='no'>obj</span>, <span class='kw'>widths</span> <span class='kw'>=</span> <span class='fu'>unit</span>(<span class='fl'>1</span>, <span class='st'>"cm"</span>), <span class='kw'>heights</span> <span class='kw'>=</span> <span class='fu'>unit</span>(<span class='fl'>1</span>, <span class='st'>"cm"</span>),
        <span class='kw'>fill</span> <span class='kw'>=</span> <span class='st'>"black"</span>, <span class='kw'>just</span> <span class='kw'>=</span> <span class='st'>"right"</span>)
<span class='fu'>sp.theme</span>(<span class='kw'>set</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>regions</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='bpy.colors.html'>bpy.colors</a></span>(<span class='fl'>100</span>)), <span class='no'>...</span>)
<span class='fu'>layout.north.arrow</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='fu'>layout.scale.bar</span>(<span class='kw'>height</span> <span class='kw'>=</span> <span class='fl'>0.05</span>)
<span class='fu'>spplot.locator</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>512</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"n"</span>, <span class='no'>...</span>)
<span class='fu'>set_col_regions</span>(<span class='no'>value</span>)
<span class='fu'>get_col_regions</span>()</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>object of class extending <a href='Spatial-class.html'>Spatial-class</a></p></td>
    </tr>
    <tr>
      <th>zcol</th>
      <td><p>character; attribute name(s) or column number(s) in attribute table</p></td>
    </tr>
    <tr>
      <th>names.attr</th>
      <td><p>names to use in panel, if different from zcol names</p></td>
    </tr>
    <tr>
      <th>scales</th>
      <td><p>scales argument to be passed to Lattice plots; use
<code><a href='https://rdrr.io/r/base/list.html'>list(draw = TRUE)</a></code> to draw axes scales; see xyplot for full options</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments passed to levelplot (grids, polygons) or 
xyplot (points)</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>label for x-axis</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>label for y-axis</p></td>
    </tr>
    <tr>
      <th>aspect</th>
      <td><p>aspect ratio for spatial axes; defaults to "iso" (one unit
on the x-axis equals one unit on the y-axis) but may be set to more
suitable values if the data are e.g. if coordinates are latitude/longitude</p></td>
    </tr>
    <tr>
      <th>panel</th>
      <td><p>depending on the class of obj, <a href='panel.html'>panel.polygonsplot</a> (for
polygons or lines), <a href='panel.html'>panel.gridplot</a> (grids) or <a href='panel.html'>panel.pointsplot</a>
(points) is used; for further control custom panel functions can be
supplied that call one of these panel functions, but do read below how the
argument <code>sp.layout</code> may help</p></td>
    </tr>
    <tr>
      <th>sp.layout</th>
      <td><p>NULL or list; see notes below</p></td>
    </tr>
    <tr>
      <th>identify</th>
      <td><p>if not FALSE, identify plotted objects (currently only working
for points plots). Labels for identification are the row.names of the
attribute table <code><a href='https://rdrr.io/r/base/row.names.html'>row.names(as.data.frame(obj))</a></code>. If TRUE, identify
on panel <code>(1,1)</code>; for identifying on panel <code>i,j</code>, pass the
value <code><a href='https://rdrr.io/r/base/c.html'>c(i,j)</a></code></p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>optional; may be useful to plot a transformed value. Defaults
to <code>z~x+y</code> for single and <code>z~x+y|name</code> for multiple attributes; use
e.g. <code>exp(x)~x+y|name</code> to plot the exponent of the z-variable</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>numeric; x-axis limits</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>numeric; y-axis limits</p></td>
    </tr>
    <tr>
      <th>edge.col</th>
      <td><p>color of symbol edge</p></td>
    </tr>
    <tr>
      <th>colorkey</th>
      <td><p>if FALSE, use symbol key; if TRUE, use continuous, levelplot-like colorkey; if list, follow syntax of argument <code>colorkey</code> in <a href='https://rdrr.io/pkg/lattice/man/levelplot.html'>levelplot</a> (see below for an example)</p></td>
    </tr>
    <tr>
      <th>widths</th>
      <td><p>width of grob</p></td>
    </tr>
    <tr>
      <th>heights</th>
      <td><p>heights of grob</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>fill color of grob</p></td>
    </tr>
    <tr>
      <th>just</th>
      <td><p>grob placement justification</p></td>
    </tr>
    <tr>
      <th>set</th>
      <td><p>logical; if TRUE, trellis.par.set is called, else a list is returned
that can be passed to trellis.par.set()</p></td>
    </tr>
    <tr>
      <th>regions</th>
      <td><p>color ramp for the theme</p></td>
    </tr>
    <tr>
      <th>height</th>
      <td><p>height of scale bar; width is 1.0</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>see locator</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>see locator</p></td>
    </tr>
    <tr>
      <th>checkEmptyRC</th>
      <td><p>logical; if TRUE, a check is done to see if
empty rows or columns are present, and need to be taken care of. Setting
to FALSE may improve speed.</p></td>
    </tr>
    <tr>
      <th>col.regions</th>
      <td><p>vector with fill colours; in case the variable
to be plotted is a factor, this vector should have length equal to the
number of factor levels</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>vector with color values, default for <code>col.regions</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>spplot returns a lattice plot of class "trellis", if you fail to "see" it,
explicitly call <code><a href='https://rdrr.io/r/base/print.html'>print(spplot(...))</a></code>. If <code>identify</code> is TRUE,
the plot is plotted and the return value is a vector with row names of
the selected points.</p>
<p><code>spplot.locator</code> returns a matrix with identified point locations;
use <code>trellis.focus</code> first to focus on a given panel.</p>
<p><code>get_col_regions</code> returns the default value for <code>col.regions</code></p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<dl'>
<dt>obj = "SpatialPixelsDataFrame"</dt><dd><p>see spplot</p></dd>
<dt>obj = "SpatialGridDataFrame"</dt><dd><p>see spplot</p></dd>
<dt>obj = "SpatialPolygonsDataFrame"</dt><dd><p>see spplot</p></dd>
<dt>obj = "SpatialLinesDataFrame"</dt><dd><p>see spplot</p></dd>
<dt>obj = "SpatialPointsDataFrame"</dt><dd><p>see spplot</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Missing values in the attributes are (currently) not allowed.</p>
<p><code>spplot.grid</code>, <code>spplot.polygons</code> and <code>spplot.points</code> are S4
methods for <code>spplot</code>; see spplot-methods.</p>
<p>Useful arguments that can be passed as <code>...</code> are:</p><dl'>
<dt><code>layout</code></dt><dd><p>integer; for the layout of panels (cols,rows)</p></dd>
<dt><code>pretty</code></dt><dd><p>logical; choose colour breaks at pretty numbers?</p></dd>
<dt><code>at</code></dt><dd><p>specify at which values colours change</p></dd>
<dt><code>as.table</code></dt><dd><p>logical; start drawing panels upper-left instead
of lower-left</p></dd>
<dt><code>page</code></dt><dd><p>to add marks to each plotted page</p></dd>

</dl>

<p>for useful values see the appropriate documentation of <a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>xyplot</a>
(in case of points), and <a href='https://rdrr.io/pkg/lattice/man/levelplot.html'>levelplot</a> (otherwise).</p>
<p>If <code>obj</code> is of SpatialPointsDataFrame, the following options are
useful to pass:</p><dl'>
<dt><code>key.space</code></dt><dd><p>character: "bottom", "right", "left" or "right" to denote
key location, or list: see argument key in the help for <a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>xyplot</a> what
the options are</p></dd>
<dt><code>legendEntries</code></dt><dd><p>character; array with key legend (text) entries; 
suitable defaults obtained from data</p></dd>
<dt><code>cuts</code></dt><dd><p>number of cuts, or, for objects of class <a href='SpatialPoints.html'>SpatialPointsDataFrame</a> only, the actual cuts to use</p></dd>
<dt><code>do.log</code></dt><dd><p>logical; if TRUE use log-linear scale to divide range in equal cuts,
else use a linear scale if <code>cuts</code> is only number of cuts</p></dd>
<dt><code>pch</code></dt><dd><p>integer; plotting character to use; defaults to 16 if fill is TRUE, else 1</p></dd>
<dt><code>cex</code></dt><dd><p>numeric; character expansion, proportional to default value of 1</p></dd>
<dt><code>fill</code></dt><dd><p>logical; use filled circles?</p></dd>

</dl>

<p><code>layout.north.arrow</code> and <code>layout.scale.bar</code> can be used
to set a north arrow or scale bar.</p>
<p>The <code>sp.layout</code> argument is either a single layout item, or a list
with one or more layout items. A layout item is one of</p><ul>
<li><p>a list with one or more <code>Spatial*</code> objects, along with
style arguments like <code>col</code>, <code>lty</code>, <code>pch</code>, <code>fill</code> etc.</p></li>
<li><p>a list with its first argument the layout function or
the name of the layout function to be called: <code>sp.points</code> for
SpatialPoints, <code>sp.polygons</code> for SpatialPolygons object, <code>sp.lines</code>
for a SpatialLines object, and <code>sp.text</code> for text to place. The
second argument contains the object (or text) to be plotted; remaining
arguments are passed to the corresponding <code>panel.*</code> functions.</p></li>
</ul>

<p>The order of items in <code>sp.layout</code> matters; objects are drawn in the
order they appear. With respect to <code>obj</code>, default plot order and
precedence of <code>sp.layout</code> items is as follows: for points and
lines, <code>sp.layout</code> items are drawn over (after) <code>obj</code>; for
grids and polygons, <code>sp.layout</code> items are drawn behind (before)
<code>obj</code>.  Transparency may further help making multiple things
visible. Adding a <code>first</code> argument to a layout item overrides its
default plotting order with respect to <code>obj</code>:</p>
<p>Special control elements of <code>sp.layout</code> items:</p><dl'>
<dt><code>first</code></dt><dd><p>logical; should the layout item be drawn before
the <code>obj</code> (TRUE), or after (FALSE)? This overrides
the default order (points and lines in front, polygons and grids behind).</p></dd>
<dt><code>which</code></dt><dd><p>integer; controls to which panel a layout
item should be added. If <code>which</code> is present in the main,
top-level list it applies to all layout items; in sub-lists with
layout items it denotes the (set of) panel(s) in which the layout
item should be drawn.  Without a <code>which</code> item, layout items
are drawn in each panel.</p></dd>

</dl>

<p><code>sp.theme</code> returns a lattice theme; use, after loading package
<code>lattice</code>, the command <code><a href='https://rdrr.io/pkg/lattice/man/trellis.par.get.html'>trellis.par.set(sp.theme())</a></code>
after a device is opened or changed to make this work. Currently, this only
sets the colors to <a href='bpy.colors.html'>bpy.colors</a>.</p>
<p>If the attributes to be plotted are of type factor, spplot tries
to create a legend that reflects this. In this case, the color ramp
passed needs to be of the same length as the number of factor levels.
The factor levels are derived from the first map; subsequent factors
with different factor levels result in an error.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='https://edzer.github.io/sp/'>https://edzer.github.io/sp/</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>xyplot</a>, <a href='https://rdrr.io/pkg/lattice/man/levelplot.html'>levelplot</a>,
<a href='https://rdrr.io/pkg/lattice/man/interaction.html'>panel.identify</a> to identify objects</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>lattice</span>)
<span class='fu'><a href='https://rdrr.io/pkg/lattice/man/trellis.par.get.html'>trellis.par.set</a></span>(<span class='fu'>sp.theme</span>()) <span class='co'># sets bpy.colors() ramp</span>
<span class='fu'><a href='https://rdrr.io/r/utils/demo.html'>demo</a></span>(<span class='no'>meuse</span>, <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>echo</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum Amersfoort in CRS definition</span></div><div class='input'><span class='no'>l2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"SpatialPolygonsRescale"</span>, <span class='fu'>layout.north.arrow</span>(), <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>181300</span>,<span class='fl'>329800</span>),
        <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>400</span>)
<span class='no'>l3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"SpatialPolygonsRescale"</span>, <span class='fu'>layout.scale.bar</span>(), <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>180500</span>,<span class='fl'>329800</span>),
        <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>fill</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"transparent"</span>,<span class='st'>"black"</span>))
<span class='no'>l4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"sp.text"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>180500</span>,<span class='fl'>329900</span>), <span class='st'>"0"</span>)
<span class='no'>l5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"sp.text"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>181000</span>,<span class='fl'>329900</span>), <span class='st'>"500 m"</span>)

<span class='fu'>spplot</span>(<span class='no'>meuse</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"ffreq"</span>), <span class='kw'>sp.layout</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>l2</span>,<span class='no'>l3</span>,<span class='no'>l4</span>,<span class='no'>l5</span>), <span class='kw'>col.regions</span><span class='kw'>=</span> <span class='st'>"black"</span>,
        <span class='kw'>pch</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>), <span class='kw'>key.space</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fl'>0.1</span>,<span class='kw'>y</span><span class='kw'>=</span><span class='fl'>.95</span>,<span class='kw'>corner</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>)))</div><div class='img'><img src='spplot-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>spplot</span>(<span class='no'>meuse</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"zinc"</span>, <span class='st'>"lead"</span>), <span class='kw'>sp.layout</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>l2</span>,<span class='no'>l3</span>,<span class='no'>l4</span>,<span class='no'>l5</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fl'>2</span>),
        <span class='kw'>key.space</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fl'>0.1</span>,<span class='kw'>y</span><span class='kw'>=</span><span class='fl'>.95</span>,<span class='kw'>corner</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>)))</div><div class='img'><img src='spplot-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># plotting factors:</span>
<span class='no'>meuse</span>$<span class='no'>f</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='no'>letters</span>[<span class='fl'>6</span>:<span class='fl'>10</span>], <span class='fl'>155</span>, <span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>),<span class='kw'>levels</span><span class='kw'>=</span><span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>10</span>])
<span class='no'>meuse</span>$<span class='no'>g</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>5</span>], <span class='fl'>155</span>, <span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>),<span class='kw'>levels</span><span class='kw'>=</span><span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>10</span>])
<span class='fu'>spplot</span>(<span class='no'>meuse</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"f"</span>,<span class='st'>"g"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='bpy.colors.html'>bpy.colors</a></span>(<span class='fl'>10</span>))</div><div class='img'><img src='spplot-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>RColorBrewer</span>)) {
        <span class='fu'>spplot</span>(<span class='no'>meuse</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"ffreq"</span>), <span class='kw'>sp.layout</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>l2</span>,<span class='no'>l3</span>,<span class='no'>l4</span>,<span class='no'>l5</span>),
                <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html'>brewer.pal</a></span>(<span class='fl'>3</span>, <span class='st'>"Set1"</span>))
}</div><div class='output co'>#&gt; <span class='message'>Loading required package: RColorBrewer</span></div><div class='img'><img src='spplot-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>meuse.grid</span>$<span class='no'>g</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>5</span>], <span class='fl'>3103</span>, <span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>),
        <span class='kw'>levels</span><span class='kw'>=</span><span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>10</span>])
<span class='no'>meuse.grid</span>$<span class='no'>f</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='no'>letters</span>[<span class='fl'>6</span>:<span class='fl'>10</span>], <span class='fl'>3103</span>, <span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>),
        <span class='kw'>levels</span><span class='kw'>=</span><span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>10</span>])
<span class='fu'>spplot</span>(<span class='no'>meuse.grid</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"f"</span>,<span class='st'>"g"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='bpy.colors.html'>bpy.colors</a></span>(<span class='fl'>10</span>))</div><div class='img'><img src='spplot-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># example modifying colorkey for points:</span>
<span class='fu'>spplot</span>(<span class='no'>meuse</span>[<span class='st'>"dist"</span>], <span class='kw'>colorkey</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
        <span class='kw'>right</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='co'># see ?levelplot in package trellis, argument colorkey:</span>
                <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>draw.colorkey</span>,
                <span class='kw'>args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
                        <span class='kw'>key</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
                                <span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>.1</span>), <span class='co'># colour breaks</span>
                                <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='bpy.colors.html'>bpy.colors</a></span>(<span class='fl'>11</span>), <span class='co'># colours</span>
                                <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
                                        <span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>.2</span>, <span class='fl'>.4</span>, <span class='fl'>.6</span>, <span class='fl'>.8</span>, <span class='fl'>1</span>),
                                        <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"0x"</span>, <span class='st'>"20x"</span>, <span class='st'>"40x"</span>, <span class='st'>"60x"</span>, <span class='st'>"80x"</span>, <span class='st'>"100x"</span>)
                                )
                        )
                )
        )
))</div><div class='img'><img src='spplot-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>l6</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>meuse.grid</span>[<span class='st'>"dist"</span>], <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/gray.html'>grey</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>.5</span>,<span class='fl'>.9</span>,<span class='kw'>length.out</span><span class='kw'>=</span><span class='fl'>10</span>)))
<span class='fu'>spplot</span>(<span class='no'>meuse</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"zinc"</span>, <span class='st'>"lead"</span>), <span class='kw'>sp.layout</span> <span class='kw'>=</span> <span class='no'>l6</span>)</div><div class='img'><img src='spplot-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>spplot</span>(<span class='no'>meuse</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"zinc"</span>, <span class='st'>"lead"</span>),
        <span class='kw'>sp.layout</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>meuse.grid</span>, <span class='no'>meuse.riv</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>'grey'</span>))</div><div class='img'><img src='spplot-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#  Custom legend placement, taken from </span>
<span class='co'># http://stackoverflow.com/questions/29344692/custom-placement-of-spplot-legend-in-the-map</span>
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'>spplot</span>(<span class='no'>meuse.grid</span>[,<span class='st'>'dist'</span>], <span class='kw'>colorkey</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>space</span> <span class='kw'>=</span> <span class='st'>"left"</span>, <span class='kw'>height</span> <span class='kw'>=</span> <span class='fl'>0.4</span>))

<span class='no'>args</span> <span class='kw'>&lt;-</span> <span class='no'>s</span>$<span class='no'>legend</span>$<span class='no'>left</span>$<span class='no'>args</span>$<span class='no'>key</span>

<span class='co'>## Prepare list of arguments needed by `legend=` argument (as described in ?xyplot)</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>lattice</span>) <span class='co'># draw.colorkey</span>
<span class='no'>legendArgs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>draw.colorkey</span>,
                   <span class='kw'>args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>key</span> <span class='kw'>=</span> <span class='no'>args</span>),
                   <span class='kw'>corner</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>,<span class='fl'>.75</span>))

<span class='co'>## Call spplot() again, this time passing in to legend the arguments</span>
<span class='co'>## needed to print a color key</span>
<span class='fu'>spplot</span>(<span class='no'>meuse.grid</span>[,<span class='st'>'dist'</span>], <span class='kw'>colorkey</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
       <span class='kw'>legend</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>inside</span> <span class='kw'>=</span> <span class='no'>legendArgs</span>))</div><div class='img'><img src='spplot-9.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edzer Pebesma, Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


